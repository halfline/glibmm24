From 437253bb2675cda0a41a27644830da3e8e74e0de Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Ha=C3=AFkel=20Gu=C3=A9mar?= <hguemar@fedoraproject.org>
Date: Sun, 4 Dec 2011 20:49:58 +0100
Subject: [PATCH] ftbfs

---
 glib/glibmm/thread.cc |   11 +++++++++++
 glib/glibmm/thread.h  |   13 ++++++++++---
 2 files changed, 21 insertions(+), 3 deletions(-)

diff --git a/glib/glibmm/thread.cc b/glib/glibmm/thread.cc
index a2b6736..8038051 100644
--- a/glib/glibmm/thread.cc
+++ b/glib/glibmm/thread.cc
@@ -417,3 +417,14 @@ void Glib::ThreadError::throw_func(GError* gobject)
 }
 
 
+void* StaticPrivate_get_helper(GStaticPrivate *private_key) {
+  return g_static_private_get(private_key);
+}
+
+void StaticPrivate_set_helper(GStaticPrivate *private_key, gpointer data, GDestroyNotify notify) {
+  return g_static_private_set(private_key, data, notify);
+}
+
+GPrivate* GPrivate_new_helper(GDestroyNotify notify) {
+  return g_private_new(notify);
+}
diff --git a/glib/glibmm/thread.h b/glib/glibmm/thread.h
index 6864d0c..197e6bb 100644
--- a/glib/glibmm/thread.h
+++ b/glib/glibmm/thread.h
@@ -1061,16 +1061,21 @@ void StaticPrivate<T>::delete_ptr(void* data)
   delete static_cast<T*>(data);
 }
 
+void* StaticPrivate_get_helper(GStaticPrivate *private_key);
+
 template <class T> inline
 T* StaticPrivate<T>::get()
 {
-  return static_cast<T*>(g_static_private_get(&gobject_));
+
+  return static_cast<T*>(StaticPrivate_get_helper(&gobject_));
 }
 
+void StaticPrivate_set_helper(GStaticPrivate *private_key, gpointer data, GDestroyNotify notify);
+
 template <class T> inline
 void StaticPrivate<T>::set(T* data, typename StaticPrivate<T>::DestroyNotifyFunc notify_func)
 {
-  g_static_private_set(&gobject_, data, notify_func);
+  StaticPrivate_set_helper(&gobject_, data, notify_func);
 }
 
 
@@ -1083,10 +1088,12 @@ void Private<T>::delete_ptr(void* data)
   delete static_cast<T*>(data);
 }
 
+GPrivate* GPrivate_new_helper(GDestroyNotify notify);
+
 template <class T> inline
 Private<T>::Private(typename Private<T>::DestructorFunc destructor_func)
 :
-  gobject_ (g_private_new(destructor_func))
+  gobject_ (GPrivate_new_helper(destructor_func))
 {}
 
 template <class T> inline
-- 
1.7.7.4

